(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-order-create"],{"0cb3":function(t,i,o){"use strict";o("7a82"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,o("a9e3");var a={props:{isMax:{type:Boolean,default:!1},isMin:{type:Boolean,default:!1},index:{type:Number,default:0},value:{type:Number,default:0},min:{type:Number,default:-1/0},max:{type:Number,default:1/0},step:{type:Number,default:1},disabled:{type:Boolean,default:!1},direction:{type:String,default:"left"}},data:function(){return{inputValue:0,minDisabled:!1,maxDisabled:!1}},created:function(){this.inputValue=this.value,this.maxDisabled=this.isMax,this.minDisabled=this.isMin},computed:{},watch:{value:function(t,i){this.inputValue=t},inputValue:function(t,i){}},methods:{_calcValue:function(t){var i=this._getDecimalScale(),o=this.inputValue*i,a=0,n=this.step*i;"subtract"===t?(a=o-n,a<=this.min&&(this.minDisabled=!0),a<this.min&&(a=this.min),a<this.max&&!0===this.maxDisabled&&(this.maxDisabled=!1)):"add"===t&&(a=o+n,a>=this.max&&(this.maxDisabled=!0),a>this.max&&(a=this.max),a>this.min&&!0===this.minDisabled&&(this.minDisabled=!1)),a!==o&&(this.inputValue=a/i,this.onChange())},_getDecimalScale:function(){var t=1;return~~this.step!==this.step&&(t=Math.pow(10,(this.step+"").split(".")[1].length)),t},_onBlur:function(t){var i=this;console.log("_onBlur",t);var o=t.detail.value;if(!o)return this.inputValue=0,void this.onChange();o=+o,o>this.max?o=this.max:o<this.min&&(o=this.min),this.inputValue=0,this.$nextTick((function(){i.inputValue=o,i.onChange()}))},onChange:function(){var t={number:this.inputValue,index:this.index};this.$emit("eventChange",t)}}};i.default=a},"0cda":function(t,i,o){var a=o("24fb");i=a(!1),i.push([t.i,'@charset "UTF-8";\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 图片加载中颜色 */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */uni-page-body[data-v-566413de]{background:#f5f5f5;padding-bottom:%?100?%}body.?%PAGE?%[data-v-566413de]{background:#f5f5f5}.goods-area .goods-item[data-v-566413de]{display:flex}.goods-area .goods-item .disabled[data-v-566413de]{color:#fff!important;width:70%;height:70%;background-color:rgba(51,51,51,.5)}.goods-area .goods-item uni-image[data-v-566413de]{flex-shrink:0;display:block;width:%?180?%;height:%?180?%;border-radius:%?4?%}.oper-area[data-v-566413de]{z-index:998;box-shadow:0 -1px 5px rgba(0,0,0,.1)}.oper-area .submit[data-v-566413de]{width:%?280?%;height:%?100?%}\n/* 优惠券区 */.coupon-area[data-v-566413de]{max-height:60vh;overflow:auto}.coupon-area .coupon-item[data-v-566413de]{margin-bottom:%?20?%}.coupon-area .coupon-item[data-v-566413de]:last-child{margin-bottom:0}.coupon-area .coupon-item .content[data-v-566413de]:after{position:absolute;left:0;bottom:0;content:"";width:100%;height:0;border-bottom:1px dashed #f3f3f3;-webkit-transform:scaleY(50%);transform:scaleY(50%)}.coupon-area .coupon-item .circle[data-v-566413de]{position:absolute;bottom:%?-10?%;z-index:10;width:%?20?%;height:%?20?%;background:#f5f5f5;border-radius:50%}.coupon-area .coupon-item .circle.r[data-v-566413de]{right:%?-6?%}.coupon-area .coupon-item .circle.l[data-v-566413de]{left:%?-6?%}.coupon-none[data-v-566413de]{width:100%;height:100%;line-height:30vh;display:flex;align-items:center;justify-content:center}.coupon-none .coupon-none-tip[data-v-566413de]{color:#909399}',""]),t.exports=i},1289:function(t,i,o){var a=o("45b5");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=o("4f06").default;n("7e501880",a,!0,{sourceMap:!1,shadowMode:!1})},2258:function(t,i,o){"use strict";o.d(i,"b",(function(){return a})),o.d(i,"c",(function(){return n})),o.d(i,"a",(function(){}));var a=function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("v-uni-view",{class:"round"==t.type?"padding-lr-sm":""},[o("v-uni-view",{staticClass:"use-list-title dflex-b padding-lr w-full bg-main",class:"round"==t.type?"border-radius":"",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.goto.apply(void 0,arguments)}}},[o("v-uni-view",{staticClass:"dflex"},[t.iconfont&&" "!=t.iconfont?o("v-uni-view",{staticClass:"iconfont __left margin-right-sm",class:t.iconfont,style:{color:t.color}}):t._e(),o("v-uni-text",{style:{fontSize:t.size+"rpx",fontWeight:t.fwt}},[t._v(t._s(t.title))])],1),o("v-uni-view",{staticClass:"dflex"},[t.tip?o("v-uni-text",{staticClass:"tip margin-right-xs"},[t._v(t._s(t.tip))]):t._e(),o("v-uni-view",{staticClass:"iconfont fs-sm",class:t.rightIcon,style:{color:t.rightColor}})],1)],1)],1)},n=[]},"45b5":function(t,i,o){var a=o("24fb");i=a(!1),i.push([t.i,".use-numbox[data-v-88ab23b4]{position:absolute;background:#f5f5f5}.use-numbox.left[data-v-88ab23b4]{left:%?30?%;bottom:0}.use-numbox.right[data-v-88ab23b4]{right:0;bottom:0}.use-numbox-minus[data-v-88ab23b4],\n.use-numbox-plus[data-v-88ab23b4]{margin:0;background-color:#f5f5f5;padding:%?12?% %?20?%}.use-numbox-minus .iconfont[data-v-88ab23b4],\n.use-numbox-plus .iconfont[data-v-88ab23b4]{color:#555;font-weight:700}.use-numbox-minus[data-v-88ab23b4]{border-right:none;border-top-left-radius:%?6?%;border-bottom-left-radius:%?6?%}.use-numbox-plus[data-v-88ab23b4]{border-left:none;border-top-right-radius:%?6?%;border-bottom-right-radius:%?6?%}.use-numbox-value[data-v-88ab23b4]{background-color:#f5f5f5;width:%?66?%;height:%?50?%;padding:0}.use-numbox-disabled.iconfont[data-v-88ab23b4]{color:#bbb}",""]),t.exports=i},6196:function(t,i,o){"use strict";o.r(i);var a=o("d971"),n=o.n(a);for(var e in a)["default"].indexOf(e)<0&&function(t){o.d(i,t,(function(){return a[t]}))}(e);i["default"]=n.a},"68fc":function(t,i,o){var a=o("7137");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=o("4f06").default;n("3fe90e3a",a,!0,{sourceMap:!1,shadowMode:!1})},"6f79":function(t,i,o){"use strict";o.d(i,"b",(function(){return a})),o.d(i,"c",(function(){return n})),o.d(i,"a",(function(){}));var a=function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("v-uni-view",{staticClass:"use-numbox pos-a dflex-c border-radius-big",class:t.direction},[o("v-uni-view",{staticClass:"use-numbox-minus pos-r tac h-full",on:{click:function(i){i.stopPropagation(),arguments[0]=i=t.$handleEvent(i),t._calcValue("subtract")}}},[o("v-uni-text",{staticClass:"iconfont iconjian fs-sm",class:t.minDisabled?"use-numbox-disabled":""})],1),o("v-uni-input",{staticClass:"use-numbox-value pos-r tac",attrs:{type:"number",disabled:t.disabled,value:t.inputValue},on:{blur:function(i){arguments[0]=i=t.$handleEvent(i),t._onBlur.apply(void 0,arguments)}}}),o("v-uni-view",{staticClass:"use-numbox-plus pos-r tac h-full",on:{click:function(i){i.stopPropagation(),arguments[0]=i=t.$handleEvent(i),t._calcValue("add")}}},[o("v-uni-text",{staticClass:"iconfont iconjia fs-sm",class:t.maxDisabled?"use-numbox-disabled":""})],1)],1)},n=[]},7137:function(t,i,o){var a=o("24fb");i=a(!1),i.push([t.i,'@charset "UTF-8";\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 图片加载中颜色 */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.use-list-title[data-v-252f08b0]{height:%?100?%;line-height:%?100?%}.use-list-title .__left[data-v-252f08b0]{font-size:%?40?%}.use-list-title .iconfont[data-v-252f08b0]{color:silver}.use-list-title .tip[data-v-252f08b0]{font-size:%?24?%;color:silver}',""]),t.exports=i},"77a79":function(t,i,o){"use strict";o.r(i);var a=o("2258"),n=o("c779");for(var e in n)["default"].indexOf(e)<0&&function(t){o.d(i,t,(function(){return n[t]}))}(e);o("bc97");var s=o("f0c5"),d=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"252f08b0",null,!1,a["a"],void 0);i["default"]=d.exports},"85f9":function(t,i,o){"use strict";o.r(i);var a=o("0cb3"),n=o.n(a);for(var e in a)["default"].indexOf(e)<0&&function(t){o.d(i,t,(function(){return a[t]}))}(e);i["default"]=n.a},8818:function(t,i,o){"use strict";var a=o("1289"),n=o.n(a);n.a},"8a71":function(t,i,o){"use strict";var a=o("bf8c"),n=o.n(a);n.a},ae8a:function(t,i,o){"use strict";o.d(i,"b",(function(){return n})),o.d(i,"c",(function(){return e})),o.d(i,"a",(function(){return a}));var a={useListTitle:o("77a79").default,useNumberBox:o("ef0c").default,usePopup:o("1d50").default},n=function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("v-uni-view",[o("v-uni-view",{staticClass:"gap"}),t.addrData&&t.addrData._id?o("v-uni-view",{staticClass:"padding dflex-b bg-main",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toaddr.apply(void 0,arguments)}}},[o("v-uni-view",{staticClass:"dflex"},[o("v-uni-view",{staticClass:"iconfont icondizhi- margin-right ft-main"}),o("v-uni-view",{staticClass:"w-full dflex-wrap-w"},[o("v-uni-view",{staticClass:"margin-bottom-xs"},[o("v-uni-text",[t._v(t._s(t.addrData.address)+" "+t._s(t.addrData.addr_detail))])],1),o("v-uni-view",[o("v-uni-text",[t._v(t._s(t.addrData.consignee))]),o("v-uni-text",{staticClass:"margin-left"},[t._v(t._s(t.addrData.mobile))])],1)],1)],1),o("v-uni-view",{staticClass:"iconfont iconjiantou-01 fs-sm"})],1):o("use-list-title",{attrs:{color:"#333",title:"选择收货人",iconfont:"icondizhi-"},on:{goto:function(i){arguments[0]=i=t.$handleEvent(i),t.toaddr.apply(void 0,arguments)}}}),o("v-uni-view",{staticClass:"gap"}),o("v-uni-view",{staticClass:"goods-area bg-main padding"},t._l(t.goodsDatas,(function(i,a){return o("v-uni-view",{key:a,staticClass:"goods-item",class:{"margin-top":a>0}},[o("v-uni-view",{staticClass:"pos-r"},[o("v-uni-image",{attrs:{mode:"aspectFill",src:i.goods.img}}),i.goods.stock_num<10||i.goods.stock_num<i.goods.goods_num?o("v-uni-view",{staticClass:"disabled dflex-c dflex-flow-c pos-a pos-tl-c border-radius-c"},[o("v-uni-text",[t._v("库存不足")]),i.goods.stock_num>0?o("v-uni-text",{staticClass:"margin-left-xs fs-xs"},[t._v("剩余\n\t\t\t\t\t\t"+t._s(i.goods.stock_num))]):t._e()],1):t._e()],1),o("v-uni-view",{staticClass:"flex1 padding-left-sm"},[o("v-uni-text",{staticClass:"title clamp-2"},[t._v(t._s(i.goods.name||"")+" "+t._s(i.goods.name_pw||""))]),o("v-uni-view",{staticClass:"ft-dark fs-xs padding-top-xs"},[t.cart_ids&&t.cart_ids.length>0?o("v-uni-text",{staticClass:"margin-right"},[t._v("× "+t._s(i.cart.goods_num))]):t._e(),t._v(t._s(i.goods_sku&&i.goods_sku.spec||"  "))],1),o("v-uni-view",{staticClass:"pos-r dflex-b padding-top"},[o("v-uni-view",{staticClass:"price flex1"},[t._v(t._s(i.goods.price/100||""))]),t.cart_ids&&t.cart_ids.length>0?t._e():o("use-number-box",{attrs:{min:1,max:i.goods.stock_num,value:i.goods.goods_num>i.goods.stock_num?i.goods.stock_num:i.goods.goods_num,"is-max":i.goods.goods_num>=i.goods.stock_num,"is-min":1===i.goods.goods_num,index:a,direction:"right"},on:{eventChange:function(i){arguments[0]=i=t.$handleEvent(i),t.numberChange.apply(void 0,arguments)}}})],1)],1)],1)})),1),o("v-uni-view",{staticClass:"gap"}),o("use-list-title",{attrs:{title:"优惠券",tip:t.couponName,color:"#333",iconfont:"iconyouhui"},on:{goto:function(i){arguments[0]=i=t.$handleEvent(i),t.couponShow=!0}}}),o("use-popup",{attrs:{mode:"bottom"},on:{open:function(i){arguments[0]=i=t.$handleEvent(i),t.couponOpen.apply(void 0,arguments)}},model:{value:t.couponShow,callback:function(i){t.couponShow=i},expression:"couponShow"}},[o("v-uni-view",{staticClass:"coupon-area padding bg-drak"},[t._l(t.couponDatas,(function(i,a){return o("v-uni-view",{key:a,staticClass:"coupon-item bg-main pos-r fs-xs"},[o("v-uni-view",{staticClass:"content pos-r padding dflex-b"},[o("v-uni-view",{},[o("v-uni-view",{staticClass:"margin-bottom-xs fs"},[t._v(t._s(i.name))]),o("v-uni-view",{staticClass:"ft-dark"},[t._v("有效期至 "+t._s(i.end_time.split(" ")[0]))])],1),o("v-uni-view",{staticClass:"tar"},[o("v-uni-view",{staticClass:"margin-bottom-xs price"},[t._v(t._s(i.price))]),i.order_amount>0?o("v-uni-view",{staticClass:"ft-dark"},[t._v("满"+t._s(i.order_amount)+"可用")]):o("v-uni-view",{staticClass:"ft-dark"},[t._v("不限")])],1),o("v-uni-view",{staticClass:"circle l"}),o("v-uni-view",{staticClass:"circle r"})],1),o("v-uni-view",{staticClass:"dflex-b"},[o("v-uni-text",{staticClass:"ft-dark padding-lr"},[t._v(t._s(i.type))]),o("v-uni-text",{staticClass:"ft-base padding-tb-sm padding-lr",on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.couponUse(i)}}},[t._v("立即使用")])],1)],1)})),!t.couponDatas||t.couponDatas.length<=0?o("v-uni-view",{staticClass:"coupon-none"},[o("v-uni-text",{staticClass:"coupon-none-tip"},[t._v("开发中!!!!!")])],1):t._e()],2)],1),o("v-uni-view",{staticClass:"gap"}),o("v-uni-view",{staticClass:"bg-main"},[o("v-uni-view",{staticClass:"dflex-b padding-lr padding-tb-sm"},[o("v-uni-view",{staticClass:"flex1"},[t._v("总金额")]),o("v-uni-view",{},[o("v-uni-text",{staticStyle:{"font-size":"24rpx"}},[t._v("￥")]),t._v(t._s(t.goods_money))],1)],1),t.total_coupon_money>0?o("v-uni-view",{staticClass:"dflex-b padding-lr padding-tb-sm"},[o("v-uni-view",{staticClass:"flex1"},[t._v("优惠金额")]),o("v-uni-view",{staticClass:"ft-base"},[t._v("-￥"+t._s(t.total_coupon_money))])],1):t._e(),o("v-uni-view",{staticClass:"dflex-b padding-lr padding-tb-sm"},[o("v-uni-view",{staticClass:"margin-right-xl"},[t._v("备注")]),o("v-uni-input",{staticClass:"flex1 padding-sm",attrs:{type:"text",placeholder:"请填写买家备注","placeholder-class":"placeholder"},model:{value:t.order_desc,callback:function(i){t.order_desc=i},expression:"order_desc"}})],1)],1),o("v-uni-view",{staticClass:"gap"}),o("v-uni-view",{staticClass:"oper-area pos-f pos-bottom w-full dflex-b bg-main safe-area-inset-bottom padding-left"},[o("v-uni-view",[o("v-uni-text",{staticClass:"fs-sm"},[t._v("实付款")]),o("v-uni-text",{staticClass:"price margin-left-sm fs-xl"},[t._v(t._s(t.total_money))])],1),o("v-uni-view",{staticClass:"submit dflex-c bg-base fs animated-all",class:1===t.is_submit?"bg-disabled":"",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.submit.apply(void 0,arguments)}}},[t._v("提交订单")])],1)],1)},e=[]},bc97:function(t,i,o){"use strict";var a=o("68fc"),n=o.n(a);n.a},bf8c:function(t,i,o){var a=o("0cda");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=o("4f06").default;n("721ca2b4",a,!0,{sourceMap:!1,shadowMode:!1})},c779:function(t,i,o){"use strict";o.r(i);var a=o("da9f"),n=o.n(a);for(var e in a)["default"].indexOf(e)<0&&function(t){o.d(i,t,(function(){return a[t]}))}(e);i["default"]=n.a},c985:function(t,i,o){"use strict";o.r(i);var a=o("ae8a"),n=o("6196");for(var e in n)["default"].indexOf(e)<0&&function(t){o.d(i,t,(function(){return n[t]}))}(e);o("8a71");var s=o("f0c5"),d=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"566413de",null,!1,a["a"],void 0);i["default"]=d.exports},d971:function(t,i,o){"use strict";o("7a82"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,o("d3b7"),o("159b");var a={data:function(){return{addrData:{},goodsDatas:[],goods_money:0,couponShow:!1,couponName:"选择优惠券",couponDatas:[],coupon_type:"满减",coupon_money:0,total_money:0,total_coupon_money:0,cart_ids:[],goods_id:0,goods_num:1,goods_sku_id:0,order_coupon_id:0,order_desc:"",is_submit:1,platform:"",platform_name:""}},onLoad:function(t){var i=this;this.$api.get_env((function(t){i.platform=t.platform,i.platform_name=t.platform_name})),this.goods_id=t.goods_id||"",this.goods_sku_id=t.sku_id||"",t.cart_ids&&(this.cart_ids=t.cart_ids.split(",")),this.loadData(),uni.$on("__event_choice_address",(function(t){i.addrData=t}))},onShow:function(){var t=this;this.addrData&&this.addrData._id||this.$db["usemall-member-address"].where("create_uid == $env.uid").tofirst().then((function(i){console.log("res",i),i&&200===i.code&&(t.addrData=i.datas)}))},methods:{loadData:function(){var t=this;this.$func.usemall.call("goods/detail2order",{cart_ids:this.cart_ids,goods_id:this.goods_id,goods_sku_id:this.goods_sku_id}).then((function(i){if(200===i.code)return t.goodsDatas=i.datas,t.calcTotalMoney(),void(t.is_submit=0);t.$api.msg(i.msg)}))},calcTotalMoney:function(){var t=this;this.goods_money=0,this.goodsDatas.forEach((function(i){i.goods_sku&&i.goods_sku.price&&(i.goods.price=i.goods_sku.price,i.goods.stock_num=i.goods_sku.stock_num),i.cart&&i.cart.goods_num&&(i.goods.goods_num=i.cart.goods_num),t.goods_money+=i.goods.price/100*i.goods.goods_num})),"满减"==this.coupon_type?(this.total_coupon_money=this.coupon_money,this.total_money=(this.goods_money+0-this.coupon_money).toFixed(2)):"折扣"==this.coupon_type&&(this.total_coupon_money=this.goods_money+0-((this.goods_money+0)*this.coupon_money).toFixed(2),this.total_money=((this.goods_money+0)*this.coupon_money).toFixed(2))},numberChange:function(t){var i=this.goodsDatas[t.index];i.goods.goods_num=t.number,this.goods_id&&(this.goods_num=t.number),this.calcTotalMoney()},couponOpen:function(){},couponUse:function(t){this.order_coupon_id=t._id,this.coupon_money=t.price,this.coupon_type=t.type,this.couponName=t.name,this.calcTotalMoney(),this.couponShow=!1},submit:function(){if(this.addrData&&this.addrData._id)if(this.is_submit)this.$api.msg("提交中");else{this.is_submit=1;var t=this,i={cart_ids:t.cart_ids,goods_id:t.goods_id,goods_num:t.goods_num,goods_sku_id:t.goods_sku_id,order_coupon_id:t.order_coupon_id,order_integral:0,order_use_integral:0,addr_id:t.addrData._id,order_from:t.platform_name,order_desc:t.order_desc};this.$func.usemall.call("order/create",i).then((function(i){200!==i.code?(t.$api.msg(i.msg),t.$api.timerout((function(){t.is_submit=0}),800)):t.$api.topay({order_id:i.datas.order_id,money:i.datas.money,type:"redirect"})}))}else this.$api.msg("请选择收货人")},toaddr:function(){uni.navigateTo({url:"/pages/user/address/address?source=1",complete:function(){}})}}};i.default=a},da9f:function(t,i,o){"use strict";o("7a82"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,o("a9e3");var a={props:{type:{type:String,default:"square"},title:{type:String,default:"列表标题"},size:{type:String,default:"28"},fwt:{type:String,default:"normal"},tip:{type:[String,Number],default:""},iconfont:{type:String,default:"icondaifahuo-"},color:{type:String,default:"#C0C4CC"},rightIcon:{type:String,default:"iconjiantou-01"},rightColor:{type:String,default:"#c0c0c0"}},data:function(){return{}},methods:{goto:function(){console.log("goto"),this.$emit("goto",{type:"goto"})}}};i.default=a},ef0c:function(t,i,o){"use strict";o.r(i);var a=o("6f79"),n=o("85f9");for(var e in n)["default"].indexOf(e)<0&&function(t){o.d(i,t,(function(){return n[t]}))}(e);o("8818");var s=o("f0c5"),d=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"88ab23b4",null,!1,a["a"],void 0);i["default"]=d.exports}}]);